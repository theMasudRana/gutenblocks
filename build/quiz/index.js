(()=>{"use strict";var e,s={102:(e,s,t)=>{const n=window.wp.blocks,i=window.wp.blockEditor,o=window.wp.components,a=window.wp.data,r=window.wp.element,c=window.wp.i18n,l=window.wp.primitives,u=window.ReactJSXRuntime,d=(0,u.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(l.Path,{d:"M12 4.75a7.25 7.25 0 100 14.5 7.25 7.25 0 000-14.5zM3.25 12a8.75 8.75 0 1117.5 0 8.75 8.75 0 01-17.5 0zM12 8.75a1.5 1.5 0 01.167 2.99c-.465.052-.917.44-.917 1.01V14h1.5v-.845A3 3 0 109 10.25h1.5a1.5 1.5 0 011.5-1.5zM11.25 15v1.5h1.5V15h-1.5z"})}),w=(0,u.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(l.Path,{d:"M2 12c0 3.6 2.4 5.5 6 5.5h.5V19l3-2.5-3-2.5v2H8c-2.5 0-4.5-1.5-4.5-4s2-4.5 4.5-4.5h3.5V6H8c-3.6 0-6 2.4-6 6zm19.5-1h-8v1.5h8V11zm0 5h-8v1.5h8V16zm0-10h-8v1.5h8V6z"})}),_=(0,u.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(l.Path,{d:"M18.5 5.5V8H20V5.5h2.5V4H20V1.5h-1.5V4H16v1.5h2.5zM12 4H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2v-6h-1.5v6a.5.5 0 01-.5.5H6a.5.5 0 01-.5-.5V6a.5.5 0 01.5-.5h6V4z"})}),g=(0,u.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(l.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12 5.5A2.25 2.25 0 0 0 9.878 7h4.244A2.251 2.251 0 0 0 12 5.5ZM12 4a3.751 3.751 0 0 0-3.675 3H5v1.5h1.27l.818 8.997a2.75 2.75 0 0 0 2.739 2.501h4.347a2.75 2.75 0 0 0 2.738-2.5L17.73 8.5H19V7h-3.325A3.751 3.751 0 0 0 12 4Zm4.224 4.5H7.776l.806 8.861a1.25 1.25 0 0 0 1.245 1.137h4.347a1.25 1.25 0 0 0 1.245-1.137l.805-8.861Z"})}),h=(0,u.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(l.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),v=(0,u.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(l.Path,{d:"m13.06 12 6.47-6.47-1.06-1.06L12 10.94 5.53 4.47 4.47 5.53 10.94 12l-6.47 6.47 1.06 1.06L12 13.06l6.47 6.47 1.06-1.06L13.06 12Z"})}),x=({question:e,questionIndex:s,correctAnswer:t,onUpdateQuestion:n,onAddAnswer:i,onRemoveAnswer:a,onUpdateAnswer:r,onSetCorrectAnswer:l,onRemoveQuestion:d})=>(0,u.jsxs)("div",{className:"gtb-quiz-edit__question",children:[(0,u.jsxs)("div",{className:"gtb-quiz-edit__question-info",children:[(0,u.jsx)(o.TextControl,{label:(0,c.__)("Question","gutenblocks"),className:"gtb-quiz-edit__question-title",__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,value:e.question,onChange:e=>n(s,{question:e})}),(0,u.jsxs)("div",{className:"gtb-quiz-edit__answers",children:[e.answers.map(((t,n)=>(0,u.jsx)(o.BaseControl,{className:"gtb-quiz-edit__answer",__nextHasNoMarginBottom:!0,label:(0,c.__)("Answer","gutenblocks"),id:`gtb-quiz-answer-${s}-${n}`,children:(0,u.jsxs)("div",{className:"gtb-quiz-edit__answer-row",children:[(0,u.jsx)(o.TextControl,{__nextHasNoMarginBottom:!0,value:t,onChange:e=>r(s,n,e)}),e.answers.length>1&&(0,u.jsx)(o.Button,{className:"gtb-quiz-edit__remove-answer",isDestructive:!0,onClick:()=>a(s,n),children:(0,u.jsx)(o.Icon,{icon:g})})]})},`${s}-answer-${n}`))),(0,u.jsx)(o.Button,{variant:"secondary",className:"gtb-quiz-edit__add-answer",onClick:()=>i(s),children:(0,u.jsx)(o.Icon,{icon:h})})]}),(0,u.jsx)(o.RadioControl,{label:(0,c.__)("SelectCorrect Answer","gutenblocks"),selected:t,options:e.answers.map((e=>({label:e||(0,c.__)("(empty)","gutenblocks"),value:e}))),onChange:e=>l(s,e)})]}),(0,u.jsx)(o.Button,{variant:"secondary",isDestructive:!0,className:"gtb-quiz-edit__remove-question",onClick:()=>d(s),children:(0,u.jsx)(o.Icon,{icon:v})})]}),z=(0,u.jsx)(l.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(l.Path,{d:"m21.5 9.1-6.6-6.6-4.2 5.6c-1.2-.1-2.4.1-3.6.7-.1 0-.1.1-.2.1-.5.3-.9.6-1.2.9l3.7 3.7-5.7 5.7v1.1h1.1l5.7-5.7 3.7 3.7c.4-.4.7-.8.9-1.2.1-.1.1-.2.2-.3.6-1.1.8-2.4.6-3.6l5.6-4.1zm-7.3 3.5.1.9c.1.9 0 1.8-.4 2.6l-6-6c.8-.4 1.7-.5 2.6-.4l.9.1L15 4.9 19.1 9l-4.9 3.6z"})}),b=({id:e,quizzes:s,isLoading:t,onQuizSelect:n,onCreateNew:i})=>t?(0,u.jsxs)("div",{className:"gtb-quiz-edit__select-loading",children:[(0,u.jsx)(o.Spinner,{}),(0,c.__)("Loading quizzes","gutenblocks")]}):(0,u.jsxs)("div",{className:"gtb-quiz-edit__select",children:[(0,u.jsxs)("h4",{className:"gtb-quiz-edit__info-title",children:[(0,u.jsx)(o.Icon,{icon:z}),(0,c.__)("Select a quiz","gutenblocks")]}),(0,u.jsx)(o.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,value:e,onChange:e=>n(parseInt(e,10)),options:[{label:(0,c.__)("Select a quiz","gutenblocks"),value:0},...s.map((e=>({label:e.title.rendered,value:e.id})))]}),0===e&&(0,u.jsx)(o.BaseControl,{className:"gtb-quiz-edit__create-button",__nextHasNoMarginBottom:!0,label:(0,c.__)("Or Create New Quiz","gutenblocks"),id:"gtb-quiz-create-button",children:(0,u.jsxs)(o.Button,{variant:"primary",onClick:i,children:[(0,u.jsx)(o.Icon,{icon:h}),(0,c.__)("Create Quiz","gutenblocks")]})})]}),p=window.wp.apiFetch;var q=t.n(p);const m={title:"",content:"",questions:[],correct_answers:[]},j={question:"",answers:[""]},k=JSON.parse('{"UU":"gutenblocks/quiz"}');(0,n.registerBlockType)(k.UU,{edit:function({attributes:e,setAttributes:s}){const{id:t}=e,n=(0,i.useBlockProps)(),{quizzes:l,isLoading:g}=(0,a.useSelect)((e=>({quizzes:e("core").getEntityRecords("postType","quiz",{per_page:-1})||[],isLoading:e("core").isResolving("getEntityRecords",["postType","quiz",{per_page:-1}])}))),{quizData:h,setQuizData:v,error:z,isSaving:p,fetchQuizData:k,saveQuiz:f}=(e=>{const[t,n]=(0,r.useState)(m),[i,o]=(0,r.useState)(null),[a,l]=(0,r.useState)(!1),u=(0,r.useCallback)((async e=>{try{o(null);const s=await q()({path:`/gutenblocks/v1/quizzes/${e}`});if(!s)throw new Error("Quiz not found");n({title:s.title||"",content:s.content||"",questions:s.questions||[],correct_answers:s.correct_answers||[]})}catch(e){o((0,c.__)("Failed to load quiz data. Please try again.","gutenblocks")),n(m)}}),[]);return{quizData:t,setQuizData:n,error:i,isSaving:a,fetchQuizData:u,saveQuiz:async()=>{if(!a)try{l(!0),o(null);const i=await q()({path:e?`/gutenblocks/v1/quizzes/${e}`:"/gutenblocks/v1/quizzes",method:e?"PUT":"POST",data:t});e||(n=i.id,s({id:n}))}catch(e){o((0,c.__)("Failed to save quiz. Please try again.","gutenblocks"))}finally{l(!1)}var n}}})(t),[S,N]=(0,r.useState)(!1);(0,r.useEffect)((()=>{t&&0!==t?k(t):v(m)}),[t,k,v]);const C=(e,s)=>{v((t=>({...t,questions:t.questions.map(((t,n)=>n===e?{...t,...s}:t))})))},V=e=>{v((s=>({...s,questions:s.questions.filter(((s,t)=>t!==e)),correct_answers:s.correct_answers.filter(((s,t)=>t!==e))})))};return(0,u.jsx)("div",{...n,children:(0,u.jsxs)("div",{className:"gtb-quiz-edit",children:[(0,u.jsx)(b,{id:t,quizzes:l,isLoading:g,onQuizSelect:e=>s({id:e}),onCreateNew:()=>{v(m),N(!0)}}),(0!==t||S)&&(0,u.jsxs)("div",{className:"gtb-quiz-edit__form",children:[z&&(0,u.jsx)("div",{className:"gtb-quiz-edit__error",children:z}),(0,u.jsx)(o.TextControl,{label:(0,c.__)("Quiz Title","gutenblocks"),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,value:h.title,onChange:e=>v((s=>({...s,title:e})))}),(0,u.jsx)(o.TextControl,{label:(0,c.__)("Quiz Description","gutenblocks"),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,value:h.content,onChange:e=>v((s=>({...s,content:e})))}),(0,u.jsxs)("h4",{className:"gtb-quiz-edit__question-area-title",children:[(0,u.jsx)(o.Icon,{icon:d}),(0,c.__)("Quiz Questions","gutenblocks")]}),(0,u.jsxs)("div",{className:"gtb-quiz-edit__questions",children:[h.questions.map(((e,s)=>(0,u.jsx)(x,{question:e,questionIndex:s,correctAnswer:h.correct_answers[s],onUpdateQuestion:C,onAddAnswer:e=>{v((s=>({...s,questions:s.questions.map(((s,t)=>t===e?{...s,answers:[...s.answers,""]}:s))})))},onRemoveAnswer:(e,s)=>{v((t=>{const n=t.questions.map(((t,n)=>{if(n===e){const e=t.answers.filter(((e,t)=>t!==s));return{...t,answers:e}}return t})),i=[...t.correct_answers];return t.questions[e]?.answers[s]===t.correct_answers[e]&&(i[e]=n[e]?.answers[0]||""),{...t,questions:n,correct_answers:i}}))},onUpdateAnswer:(e,s,t)=>{v((n=>{const i=n.questions.map(((n,i)=>i===e?{...n,answers:n.answers.map(((e,n)=>n===s?t:e))}:n)),o=n.questions[e]?.answers[s],a=[...n.correct_answers];return o===n.correct_answers[e]&&(a[e]=t),{...n,questions:i,correct_answers:a}}))},onSetCorrectAnswer:(e,s)=>{v((t=>{const n=[...t.correct_answers];return n[e]=s,{...t,correct_answers:n}}))},onRemoveQuestion:V},s))),(0,u.jsx)(o.Button,{variant:"secondary",className:"gtb-quiz-edit__add-question",onClick:()=>{v((e=>({...e,questions:[...e.questions,{...j}],correct_answers:[...e.correct_answers,""]})))},size:"compact",icon:w,children:(0,c.__)("Add Question","gutenblocks")})]}),(0,u.jsx)(o.Button,{variant:"primary",className:"gtb-quiz-edit__save",onClick:f,isBusy:p,disabled:p,icon:_,children:p?(0,c.__)("Saving","gutenblocks"):(0,c.__)("Save Quiz","gutenblocks")})]})]})})}})}},t={};function n(e){var i=t[e];if(void 0!==i)return i.exports;var o=t[e]={exports:{}};return s[e](o,o.exports,n),o.exports}n.m=s,e=[],n.O=(s,t,i,o)=>{if(!t){var a=1/0;for(u=0;u<e.length;u++){for(var[t,i,o]=e[u],r=!0,c=0;c<t.length;c++)(!1&o||a>=o)&&Object.keys(n.O).every((e=>n.O[e](t[c])))?t.splice(c--,1):(r=!1,o<a&&(a=o));if(r){e.splice(u--,1);var l=i();void 0!==l&&(s=l)}}return s}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[t,i,o]},n.n=e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return n.d(s,{a:s}),s},n.d=(e,s)=>{for(var t in s)n.o(s,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:s[t]})},n.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),(()=>{var e={437:0,313:0};n.O.j=s=>0===e[s];var s=(s,t)=>{var i,o,[a,r,c]=t,l=0;if(a.some((s=>0!==e[s]))){for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(c)var u=c(n)}for(s&&s(t);l<a.length;l++)o=a[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(u)},t=globalThis.webpackChunkgutenblocks=globalThis.webpackChunkgutenblocks||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))})();var i=n.O(void 0,[313],(()=>n(102)));i=n.O(i)})();