(()=>{"use strict";var e,s={726:(e,s,t)=>{const n=window.wp.blocks,o=window.wp.apiFetch;var a=t.n(o);const i=window.wp.blockEditor,r=window.wp.components,l=window.wp.data,c=window.wp.element,u=window.wp.i18n,_=window.wp.primitives,d=window.ReactJSXRuntime,g=(0,d.jsx)(_.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,d.jsx)(_.Path,{d:"M11 12.5V17.5H12.5V12.5H17.5V11H12.5V6H11V11H6V12.5H11Z"})}),w=(0,d.jsx)(_.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,d.jsx)(_.Path,{d:"m13.06 12 6.47-6.47-1.06-1.06L12 10.94 5.53 4.47 4.47 5.53 10.94 12l-6.47 6.47 1.06 1.06L12 13.06l6.47 6.47 1.06-1.06L13.06 12Z"})}),b={title:"",content:"",questions:[],correct_answers:[]},v={question:"",answers:[""]},p=JSON.parse('{"UU":"gutenblocks/quizcpt"}');(0,n.registerBlockType)(p.UU,{edit:function({attributes:e,setAttributes:s}){const{id:t}=e,[n,o]=(0,c.useState)(b),[_,p]=(0,c.useState)(null),[x,q]=(0,c.useState)(!1),h=(0,i.useBlockProps)(),{quizzes:m,isLoading:z}=((()=>{const[e,s]=(0,c.useState)(!1),t=(0,c.useRef)(!1),{isSavingPost:n,isAutosavingPost:o}=(0,l.useSelect)((e=>({isSavingPost:e("core/editor").isSavingPost(),isAutosavingPost:e("core/editor").isAutosavingPost()})));(0,c.useEffect)((()=>{!n&&!o||t.current||(s(!1),t.current=!0),n||o||!t.current||(s(!0),t.current=!1)}),[n,o])})(),(0,l.useSelect)((e=>({quizzes:e("core").getEntityRecords("postType","quiz",{per_page:-1})||[],isLoading:e("core").isResolving("getEntityRecords",["postType","quiz",{per_page:-1}])})))),k=(0,c.useCallback)((async e=>{try{p(null);const s=await a()({path:`/gutenblocks/v1/quizzes/${e}`});if(!s)throw new Error("Quiz not found");o({title:s.title||"",content:s.content||"",questions:s.questions||[],correct_answers:s.correct_answers||[]})}catch(e){p((0,u.__)("Failed to load quiz data. Please try again.","gutenblocks")),o(b)}}),[]);(0,c.useEffect)((()=>{t&&0!==t?k(t):o(b)}),[t,k]);const j=(0,c.useCallback)(((e,s)=>{o((t=>({...t,questions:t.questions.map(((t,n)=>n===e?{...t,...s}:t))})))}),[]),f=(0,c.useCallback)((e=>{o((s=>({...s,questions:s.questions.map(((s,t)=>t===e?{...s,answers:[...s.answers,""]}:s))})))}),[]),C=(0,c.useCallback)(((e,s)=>{o((t=>{const n=t.questions.map(((t,n)=>{if(n===e){const e=t.answers.filter(((e,t)=>t!==s));return{...t,answers:e}}return t})),o=[...t.correct_answers];return t.questions[e]?.answers[s]===t.correct_answers[e]&&(o[e]=n[e]?.answers[0]||""),{...t,questions:n,correct_answers:o}}))}),[]),N=(0,c.useCallback)(((e,s,t)=>{o((n=>{const o=n.questions.map(((n,o)=>o===e?{...n,answers:n.answers.map(((e,n)=>n===s?t:e))}:n)),a=n.questions[e]?.answers[s],i=[...n.correct_answers];return a===n.correct_answers[e]&&(i[e]=t),{...n,questions:o,correct_answers:i}}))}),[]),y=(0,c.useCallback)((()=>{o((e=>({...e,questions:[...e.questions,{...v}],correct_answers:[...e.correct_answers,""]})))}),[]),S=(0,c.useCallback)((e=>{o((s=>({...s,questions:s.questions.filter(((s,t)=>t!==e)),correct_answers:s.correct_answers.filter(((s,t)=>t!==e))})))}),[]);return(0,d.jsx)("div",{...h,children:(0,d.jsxs)("div",{className:"gtb-quiz",children:[z?(0,d.jsxs)("div",{className:"gtb-quiz__select-loading",children:[(0,d.jsx)(r.Spinner,{}),(0,u.__)("Loading quizzes","gutenblocks")]}):(0,d.jsxs)("div",{className:"gtb-quiz__select",children:[(0,d.jsx)(r.SelectControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,label:(0,u.__)("Select a quiz","gutenblocks"),value:t,onChange:e=>{s({id:parseInt(e,10)})},options:[{label:(0,u.__)("Select a quiz","gutenblocks"),value:0},...m.map((e=>({label:e.title.rendered,value:e.id})))]}),0===t&&(0,d.jsx)(r.BaseControl,{className:"gtb-quiz__create-button",__nextHasNoMarginBottom:!0,label:(0,u.__)("Or Create New Quiz","gutenblocks"),id:"gtb-quiz-create-button",children:(0,d.jsxs)(r.Button,{variant:"primary",onClick:()=>o(b),children:[(0,d.jsx)(r.Icon,{icon:g}),(0,u.__)("Create Quiz","gutenblocks")]})})]}),_&&(0,d.jsx)("div",{className:"gtb-quiz__error",children:_}),(0,d.jsxs)("div",{className:"gtb-quiz__form",children:[(0,d.jsx)(r.TextControl,{label:(0,u.__)("Quiz Title","gutenblocks"),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,value:n.title,onChange:e=>{o((s=>({...s,title:e})))}}),(0,d.jsx)(r.TextControl,{label:(0,u.__)("Quiz Description","gutenblocks"),__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,value:n.content,onChange:e=>{o((s=>({...s,content:e})))}}),(0,d.jsx)("h4",{children:(0,u.__)("Quiz Questions","gutenblocks")}),(0,d.jsxs)("div",{className:"gtb-quiz__questions",children:[n.questions.map(((e,s)=>(0,d.jsxs)("div",{className:"gtb-quiz__question",children:[(0,d.jsxs)("div",{className:"gtb-quiz__question-info",children:[(0,d.jsx)(r.TextControl,{label:(0,u.__)("Question","gutenblocks"),className:"gtb-quiz__question-title",__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0,value:e.question,onChange:e=>j(s,{question:e})}),(0,d.jsxs)("div",{className:"gtb-quiz__answers",children:[e.answers.map(((t,n)=>(0,d.jsx)(r.BaseControl,{className:"gtb-quiz__answer",__nextHasNoMarginBottom:!0,label:(0,u.__)("Answer","gutenblocks"),id:`gtb-quiz-answer-${s}-${n}`,children:(0,d.jsxs)("div",{className:"gtb-quiz__answer-row",children:[(0,d.jsx)(r.TextControl,{__nextHasNoMarginBottom:!0,value:t,onChange:e=>N(s,n,e)}),e.answers.length>1&&(0,d.jsx)(r.Button,{className:"gtb-quiz__remove-answer",isDestructive:!0,onClick:()=>C(s,n),children:(0,d.jsx)(r.Icon,{icon:w})})]})},`${s}-answer-${n}`))),(0,d.jsx)(r.Button,{variant:"secondary",className:"gtb-quiz__add-answer",onClick:()=>f(s),children:(0,u.__)("Add Answer","gutenblocks")})]}),(0,d.jsx)(r.RadioControl,{label:(0,u.__)("Correct Answer","gutenblocks"),selected:n.correct_answers[s],options:e.answers.map((e=>({label:e||(0,u.__)("(empty)","gutenblocks"),value:e}))),onChange:e=>{const t=[...n.correct_answers];t[s]=e,o((e=>({...e,correct_answers:t})))}})]}),(0,d.jsx)(r.Button,{variant:"secondary",isDestructive:!0,className:"gtb-quiz__remove-question",onClick:()=>S(s),children:(0,d.jsx)(r.Icon,{icon:w})})]},s))),(0,d.jsx)(r.Button,{variant:"secondary",className:"gtb-quiz__add-question",onClick:y,children:(0,u.__)("Add Question","gutenblocks")})]}),(0,d.jsx)(r.Button,{variant:"primary",className:"gtb-quiz__save",onClick:async()=>{if(!x)try{q(!0),p(null);const e=await a()({path:t?`/gutenblocks/v1/quizzes/${t}`:"/gutenblocks/v1/quizzes",method:t?"PUT":"POST",data:n});t||s({id:e.id})}catch(e){p((0,u.__)("Failed to save quiz. Please try again.","gutenblocks"))}finally{q(!1)}},isBusy:x,disabled:x,children:x?(0,u.__)("Saving","gutenblocks"):(0,u.__)("Save Quiz","gutenblocks")})]})]})})}})}},t={};function n(e){var o=t[e];if(void 0!==o)return o.exports;var a=t[e]={exports:{}};return s[e](a,a.exports,n),a.exports}n.m=s,e=[],n.O=(s,t,o,a)=>{if(!t){var i=1/0;for(u=0;u<e.length;u++){for(var[t,o,a]=e[u],r=!0,l=0;l<t.length;l++)(!1&a||i>=a)&&Object.keys(n.O).every((e=>n.O[e](t[l])))?t.splice(l--,1):(r=!1,a<i&&(i=a));if(r){e.splice(u--,1);var c=o();void 0!==c&&(s=c)}}return s}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[t,o,a]},n.n=e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return n.d(s,{a:s}),s},n.d=(e,s)=>{for(var t in s)n.o(s,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:s[t]})},n.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),(()=>{var e={730:0,774:0};n.O.j=s=>0===e[s];var s=(s,t)=>{var o,a,[i,r,l]=t,c=0;if(i.some((s=>0!==e[s]))){for(o in r)n.o(r,o)&&(n.m[o]=r[o]);if(l)var u=l(n)}for(s&&s(t);c<i.length;c++)a=i[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(u)},t=globalThis.webpackChunkgutenblocks=globalThis.webpackChunkgutenblocks||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))})();var o=n.O(void 0,[774],(()=>n(726)));o=n.O(o)})();