{"version":3,"file":"quizcpt/view.js","mappings":"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","sources":["webpack://gutenblocks/external module \"@wordpress/interactivity\"","webpack://gutenblocks/webpack/bootstrap","webpack://gutenblocks/webpack/runtime/make namespace object","webpack://gutenblocks/./src/quizcpt/view.js"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress dependencies\n */\nimport { store } from '@wordpress/interactivity';\n\n// Constants for selectors.\nconst SELECTORS = {\n\tDIALOG: '.gtb-quiz__status-dialog',\n\tANSWER_INPUT: '.gtb-quiz__answer-input',\n};\n\n// API endpoint.\nconst API_ENDPOINT = '/wp-json/gutenblocks/v1/quizzes';\n\n// Initial state\nconst initialState = {\n\tanswered: 0,\n\tcorrect: 0,\n\tallCorrect: false,\n\tmodal_title: 'Quiz Results',\n};\n\n// Get checked answers.\nconst getCheckedAnswers = () => {\n\tconst inputs = document.querySelectorAll(\n\t\tSELECTORS.ANSWER_INPUT + ':checked'\n\t);\n\treturn Array.from( inputs ).map( ( input ) => ( {\n\t\tquestionIndex: parseInt( input.name.split( '_' )[ 1 ], 10 ),\n\t\tanswer: input.value,\n\t} ) );\n};\n\n// Reset inputs.\nconst resetInputs = () => {\n\tdocument\n\t\t.querySelectorAll( SELECTORS.ANSWER_INPUT )\n\t\t.forEach( ( input ) => ( input.checked = false ) );\n};\n\n// Get dialog.\nconst getDialog = () => document.querySelector( SELECTORS.DIALOG );\n\n// Store configuration.\nconst { state } = store( 'gutenblocks/quizcpt', {\n\tactions: {\n\t\tresetQuiz: () => {\n\t\t\tObject.assign( state, initialState );\n\t\t\tresetInputs();\n\n\t\t\tconst dialog = getDialog();\n\t\t\tif ( dialog?.open ) {\n\t\t\t\tdialog.close();\n\t\t\t}\n\t\t},\n\n\t\tasync checkAnswers() {\n\t\t\ttry {\n\t\t\t\t// Fetch quiz data.\n\t\t\t\tconst response = await fetch(\n\t\t\t\t\t`${ state.site_url }${ API_ENDPOINT }/${ state.quiz_id }`,\n\t\t\t\t\t{\n\t\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tif ( ! response.ok ) {\n\t\t\t\t\tthrow new Error( 'Failed to fetch quiz data' );\n\t\t\t\t}\n\n\t\t\t\tconst data = await response.json();\n\t\t\t\tconst { questions, correct_answers: correctAnswers } = data;\n\n\t\t\t\t// Reset state.\n\t\t\t\tstate.answered = 0;\n\t\t\t\tstate.correct = 0;\n\t\t\t\tstate.modal_title = state.modal_title;\n\n\t\t\t\t// Get user answers.\n\t\t\t\tconst userAnswers = getCheckedAnswers();\n\t\t\t\tstate.answered = userAnswers.length;\n\n\t\t\t\t// Check answers.\n\t\t\t\tstate.correct = userAnswers.reduce(\n\t\t\t\t\t( correct, { questionIndex, answer } ) =>\n\t\t\t\t\t\tcorrect +\n\t\t\t\t\t\t( answer === correctAnswers[ questionIndex ] ? 1 : 0 ),\n\t\t\t\t\t0\n\t\t\t\t);\n\n\t\t\t\t// Update completion state.\n\t\t\t\tstate.allCorrect =\n\t\t\t\t\tstate.answered === questions.length &&\n\t\t\t\t\tstate.correct === questions.length;\n\n\t\t\t\t// Update dialog title.\n\t\t\t\tstate.modal_title = state.allCorrect\n\t\t\t\t\t? state.all_correct_title\n\t\t\t\t\t: state.modal_title;\n\n\t\t\t\t// Show results.\n\t\t\t\tgetDialog()?.showModal();\n\t\t\t} catch ( error ) {\n\t\t\t\tthrow new Error( 'Failed to check answers' );\n\t\t\t}\n\t\t},\n\n\t\t// Close dialog.\n\t\tmodalClose: () => {\n\t\t\tObject.assign( state, initialState );\n\t\t\tresetInputs();\n\t\t\tgetDialog()?.close();\n\t\t},\n\t},\n} );\n"],"names":["store","SELECTORS","DIALOG","ANSWER_INPUT","API_ENDPOINT","initialState","answered","correct","allCorrect","modal_title","getCheckedAnswers","inputs","document","querySelectorAll","Array","from","map","input","questionIndex","parseInt","name","split","answer","value","resetInputs","forEach","checked","getDialog","querySelector","state","actions","resetQuiz","Object","assign","dialog","open","close","checkAnswers","response","fetch","site_url","quiz_id","method","headers","ok","Error","data","json","questions","correct_answers","correctAnswers","userAnswers","length","reduce","all_correct_title","showModal","error","modalClose"],"sourceRoot":""}